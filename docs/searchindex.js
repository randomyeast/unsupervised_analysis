Search.setIndex({"docnames": ["datasets", "distributions", "index", "lib", "models", "modules", "mouse_v1", "test", "tvae", "tvae_decoder_explanation", "tvae_encoder_explanation", "util"], "filenames": ["datasets.rst", "distributions.rst", "index.rst", "lib.rst", "models.rst", "modules.rst", "mouse_v1.rst", "test.rst", "tvae.rst", "tvae_decoder_explanation.rst", "tvae_encoder_explanation.rst", "util.rst"], "titles": ["lib.util.datasets", "lib.distributions", "Welcome to the documentation for the Kennedy lab\u2019s unsupervised analysis tools!", "vq-triplet-treba.lib", "lib.models", "unsupervised_analysis", "lib.util.datasets.mouse_v1", "test module", "lib.models.tvae", "TVAE decoder explanation", "TVAE encoder explanation", "lib.util"], "terms": {"random_trajectori": [], "class": [0, 1, 4, 6, 8], "core": [0, 1, 4, 6, 8], "trajectorydataset": [0, 2, 8], "data_config": [0, 2, 6], "all_stat": 0, "none": [0, 1, 8], "base": [0, 2, 6], "fix": [0, 8], "length": [0, 6, 8, 10], "trajectori": [0, 2, 6, 8, 9], "__getitem__": 0, "idx": 0, "return": [0, 1, 2, 4, 6, 8], "from": [0, 1, 2, 4, 6, 8, 9, 10], "either": 0, "train": [0, 6, 8], "test": [0, 3, 5, 8], "set": [0, 4, 6, 8, 9, 10], "__init__": [0, 4, 6, 8], "abstract": [0, 1, 4], "when": [0, 9, 10], "work": [0, 2, 4, 6, 10], "ani": [0, 1, 2, 10], "new": 0, "type": [0, 1, 2, 4, 6, 8], "creat": 0, "subclass": 0, "thi": [0, 2, 4, 6, 8, 9, 10], "paramet": [0, 1, 2, 4, 6, 8, 10], "dict": [0, 4, 6, 8], "A": [0, 4, 6, 8], "dictionari": [0, 2, 4, 6, 8, 10], "contain": [0, 2, 4, 6, 8], "follow": [0, 4, 6, 8, 10], "model": [0, 3, 9, 10], "attribut": [0, 4, 6, 8, 10], "test_proport": 0, "float": [0, 1, 4], "option": [0, 1, 4, 8], "proport": 0, "us": [0, 1, 4, 6, 8, 9, 10], "traj_len": [0, 2, 6, 8], "int": [0, 4, 6, 8], "frame": [0, 2, 6], "Not": 0, "object": [0, 1, 6, 8], "recommend": 0, "implement": [0, 2], "__len__": 0, "eval": 0, "evalu": [0, 2, 8], "mode": 0, "load_data": [0, 2, 6], "load": [0, 2, 6, 8], "must": [0, 2], "It": [0, 2], "tensor": [0, 1, 2, 4, 8, 10], "shape": [0, 2, 6, 8, 10], "num_trajectori": 0, "trajectory_length": [0, 8], "feature_dim": 0, "If": [1, 2, 4, 8, 9, 10], "you": [1, 2, 4], "ar": [1, 2, 4, 6, 8, 9, 10], "interest": [1, 2], "addit": [1, 2], "add": [1, 2, 4, 6], "them": [1, 2, 4, 6], "modul": [1, 3, 5, 8, 10], "other": [1, 4], "inherit": [1, 2, 4], "normal": [1, 8, 9], "mean": [1, 2, 4, 8, 9, 10], "logvar": [1, 8], "repres": [1, 2, 6, 8, 10], "gaussian": [1, 8], "static": [1, 6], "kl_diverg": 1, "normal_1": 1, "normal_2": 1, "free_bit": 1, "0": [1, 8, 10], "comput": [1, 8, 9, 10], "kl": 1, "diverg": 1, "between": 1, "two": [1, 6, 8, 9, 10], "note": [1, 6], "nll": [1, 8], "instead": [1, 9], "standard": 1, "deviat": 1, "we": [1, 8], "infer": [1, 2, 8, 10], "log": [1, 2, 4, 8, 9, 10], "varianc": [1, 8, 9, 10], "output": [1, 2, 4, 6, 8, 9, 10], "encod": [1, 2, 3, 4, 8, 9], "frac": [1, 10], "sigma_1": 1, "sigma_": 1, "2": [1, 10], "1": [1, 4, 8, 9, 10], "mu_1": 1, "mu_2": 1, "sigma": [1, 10], "_": 1, "The": [1, 2, 4, 6, 8, 9, 10], "first": [1, 2, 6, 8, 10], "equat": [1, 10], "abov": [1, 8, 9, 10], "second": [1, 2, 8, 10], "includ": 1, "assum": [1, 6, 8], "unit": [1, 4, 8, 9, 10], "scalar": 1, "valu": [0, 1, 4, 10], "intend": 1, "keep": 1, "posterior": [1, 2, 8, 10], "collaps": 1, "prior": 1, "kld": 1, "fall": 1, "below": 1, "particular": 1, "dimens": [1, 2, 4, 10], "s": [1, 10], "assign": 1, "kullback": 1, "leibler": 1, "torch": [1, 2, 4, 8, 10], "log_prob": 1, "neg": [1, 2, 8, 9], "likelihood": [1, 2, 8, 9], "given": [1, 8], "shown": [1, 9, 10], "probabl": 1, "densiti": 1, "function": [1, 2, 6, 10], "actual": 1, "ln": 1, "pi": [1, 9], "x": [1, 2, 8, 10], "mu": 1, "potenti": 1, "multi": 1, "dimension": [1, 2, 4, 8, 10], "sum": [1, 8, 10], "each": [1, 2, 6, 8, 9, 10], "sampl": [1, 8, 9], "temperatur": [1, 8], "gener": [1, 8, 9], "random": [1, 8], "re": [1, 2], "parameter": [1, 8, 10], "trick": 1, "make": [1, 2, 4], "backpropag": 1, "possibl": [1, 2], "estim": [1, 6], "std": 1, "z": [1, 8, 9], "epsilon": 1, "cdot": 1, "t": [1, 6, 8, 9, 10], "scale": 1, "more": [2, 6, 9], "readabl": [], "These": 2, "page": 2, "relev": 2, "method": [2, 6], "ann": 2, "northwestern": 2, "univers": 2, "There": [2, 10], "current": [2, 4, 8, 9, 10], "three": 2, "avail": [2, 8, 10], "variat": [2, 8, 9, 10], "autoencod": [2, 8], "tvae": [3, 4], "vector": [2, 6, 8, 10], "quantiz": 2, "triplet": 2, "loss": [2, 4, 8, 9], "goal": 2, "both": [2, 6, 10], "explain": [2, 4, 6, 9], "how": [2, 6, 10], "variant": 2, "easi": [2, 8], "adapt": 2, "split": [2, 6], "concis": [], "refer": 2, "meant": 2, "those": 2, "modifi": 2, "well": 2, "section": 2, "explicit": 2, "mathemat": 2, "detail": [2, 8, 9], "suggest": 2, "than": 2, "To": [2, 10], "need": [2, 6], "which": [2, 4, 8, 10], "an": [2, 4, 8, 9, 10], "exampl": [2, 10], "mousev1": [], "onc": 2, "complet": 2, "onli": [], "overrid": 2, "where": [2, 10], "should": [2, 4, 10], "all": [2, 6, 8], "data": [2, 8], "preprocess": [0, 2, 6], "high": [], "level": [], "path": [2, 6, 8], "emb": [2, 8], "etc": 2, "pass": [2, 4, 8, 10], "your": [], "ve": [], "made": [], "copi": 2, "example_tva": 2, "your_new_project_nam": 2, "updat": [2, 4], "state_dim": [2, 8, 10], "config": [2, 8], "json": [2, 6], "file": [2, 6], "so": [], "reflect": 2, "number": [4, 6, 8, 10], "featur": 4, "chang": [2, 4, 8, 10], "name": [2, 8], "configur": [2, 10], "run": 2, "python": 2, "py": 2, "config_dir": [2, 8], "your_experiment_nam": 2, "like": 2, "take": [2, 6], "sever": 2, "hour": 2, "converg": 2, "depend": 2, "hardwar": 2, "much": 2, "ha": 2, "directori": [2, 6, 8], "titl": 2, "stage_": 2, "within": [2, 4, 10], "stage": 2, "have": [2, 4], "call": [2, 6, 10], "best": 2, "pt": 2, "checkpoint": [2, 8], "lowest": [2, 8], "squar": [], "error": [], "reconstruct": [4, 6, 8, 9], "entir": [], "latest": [], "under": [2, 8, 9], "construct": 2, "lib": 2, "distribut": [2, 3, 8, 9, 10], "util": [2, 3, 8], "index": [2, 10], "search": [2, 6], "nest": 3, "document": 3, "dataset": [3, 11], "basesequentialmodel": 4, "model_config": [2, 4, 8], "defin": [4, 8], "submodul": 4, "initi": [4, 8], "specifi": [2, 4, 6, 10], "recurr": [4, 8, 9, 10], "bool": [4, 8], "whether": [4, 8], "decod": [2, 3, 4, 8], "rnn_dim": [4, 8, 10], "integ": 4, "hidden": [4, 8, 9, 10], "num_lay": [4, 8, 10], "layer": [2, 4, 8, 9, 10], "label_dim": 4, "label": 4, "task": 4, "e": [0, 2, 4, 6, 8], "g": [0, 2, 4, 6], "3": 4, "bin": 4, "init_hidden_st": [4, 8], "batch_siz": [4, 8, 10], "state": [4, 8, 9, 10], "zero": [4, 8], "neural": 4, "network": [4, 8, 10], "todo": 4, "one": [4, 6, 8], "what": [2, 4, 10], "properti": 4, "num_paramet": 4, "count": 4, "learnabl": [4, 8], "self": [4, 10], "_num_paramet": 4, "alreadi": 4, "been": 4, "store": [2, 4, 6, 8], "result": [4, 6], "optim": [4, 8], "grad_clip": 4, "10": [4, 8], "provid": [4, 8], "locat": 4, "whatev": 4, "maximum": 4, "gradient": 4, "magnitud": 4, "clip": 4, "rnn": [4, 8, 10], "sometim": 4, "issu": 4, "explod": 4, "wai": 4, "prevent": 4, "update_hidden": 4, "action": [4, 8, 9, 10], "singl": [4, 6], "step": [2, 4, 6, 8, 9, 10], "being": [2, 4], "input": [2, 4, 8, 9, 10], "produc": [4, 8], "final": [4, 8, 10], "mayb": 4, "some": [2, 4], "sort": 4, "diagram": 4, "autoencd": [], "architectur": [2, 8], "over": [6, 8, 10], "latent": [8, 9, 10], "space": [8, 10], "tvaeencod": 8, "tvaedecod": 8, "fit": [0, 8], "data_load": 8, "devic": [2, 8], "cuda": 8, "epoch": 2, "forward": 8, "fals": [8, 9], "true": [8, 9, 10], "model_param": 8, "list": [2, 8], "num_sampl": 8, "save_checkpoint": 8, "save": 8, "experi": 8, "kwarg": 8, "portion": [8, 9, 10], "while": 10, "default": [9, 10], "gate": 10, "gru": [8, 10], "can": [2, 10], "describ": [8, 10], "simpler": 10, "succes": 10, "propag": 10, "denot": [8, 9, 10], "h_": [8, 10], "j": [8, 10], "time": [6, 8, 9, 10], "give": 10, "let": 10, "x_t": 10, "concaten": [6, 9, 10], "s_t": 10, "a_t": 10, "a_": [9, 10], "s_": [9, 10], "pytorch": 10, "basic": [6, 10], "g_": 10, "w_": [8, 10], "x_": 10, "b_": 10, "u_": 10, "matrix": [6, 10], "learn": [2, 8, 10], "weight": [6, 10], "map": [8, 10], "correspond": [2, 8, 9, 10], "bias": 10, "previou": [8, 9, 10], "differ": [2, 10], "activ": 10, "nn": 10, "hyperbol": 10, "tagent": 10, "enc_birnn": 10, "seq_len": [8, 10], "tupl": 10, "red": 10, "along": 10, "blue": 10, "fulli": [8, 9, 10], "connect": [8, 9, 10], "m": [8, 10], "sequenc": 10, "respect": [2, 10], "final_hidden": [8, 10], "In": [2, 10], "case": 10, "through": [8, 10], "h_dim": [8, 10], "relu": 10, "enc_fc": [8, 10], "separ": [8, 9, 10], "enc_mean": [8, 10], "enc_logvar": [8, 10], "i": [6, 8], "element": 8, "column": 8, "row": 8, "z_dim": 8, "omit": 8, "action_dim": 8, "next": [2, 8, 9], "q_": 8, "phi": 8, "encoder_explan": [], "similar": 9, "timestep": [8, 9], "variabl": [8, 9], "last": 9, "fed": 9, "dec_action_fc": [8, 9], "dec_action_mean": 9, "dec_action_logvar": 9, "predict": [8, 9], "calcul": 9, "teacher_forc": [8, 9], "rollout": 9, "process": 9, "tild": 9, "roll": 8, "out": 8, "decode_act": 8, "action_likelihood": 8, "parent": 8, "same": [6, 8], "generate_rollout": 8, "reset_polici": 8, "explan": [2, 3, 4, 8], "here": [2, 8, 9], "rel": 8, "simpl": 8, "lower": 8, "embed": 8, "param": [], "wrapper": 8, "around": 8, "dataload": 8, "http": [], "org": [], "doc": [], "stabl": [], "html": [], "perform": [6, 8], "allow": 8, "batch": [2, 8], "num_traj": [2, 6, 8], "num_feat": [6, 8], "draw": 8, "correct": 8, "convent": 8, "str": [6, 8], "success": 8, "try": 8, "replic": 8, "recon": [6, 8], "update_hidden_st": 8, "execut": 8, "mouse_v1": [0, 2, 3, 11], "mousev1dataset": [2, 6], "handl": 6, "mous": 6, "mar": 6, "keypoint": 6, "root_data_dir": [2, 6], "root": [2, 6], "look": 6, "see": 6, "link": 6, "structur": 6, "properli": 6, "dataset_typ": 6, "load_dataset": 6, "video": [2, 6], "fit_preprocess": 0, "singular": [0, 6], "decomposit": [0, 6], "register_mars_trajectory_centroid": 6, "regist": 6, "pose": 6, "centroid": 6, "start": 6, "np": [2, 6], "arrai": [2, 6], "n_featur": 6, "register_pose_trajectori": 6, "61": 6, "w": 6, "r": 6, "bodi": 6, "angl": 6, "register_mars_trajectory_angl": 6, "form": 6, "y": 6, "axi": 6, "convert": 6, "constructor": 6, "neck": 6, "origin": 6, "tail": 6, "align": 6, "Then": [], "reduc": [], "rotat": 6, "combin": 6, "center": 6, "coordin": 6, "sine": 6, "cosin": 6, "svd": 6, "associ": 6, "right": 6, "extract": 6, "posit": 6, "back": 6, "up": 6, "its": 6, "med_filt": 6, "kernel_s": 6, "7": 6, "appli": 6, "median": 6, "filter": 6, "remov": 6, "nois": 6, "filtered_trajectori": 6, "postprocess": 6, "decompos": 6, "reconstructed_trajectori": 6, "register_mars_trajectory_body_angl": 6, "cluster": 2, "requir": 2, "post": 2, "hoc": 2, "doe": 2, "behavior": 2, "motif": 2, "num_featur": 2, "folder": [], "expect": 2, "kei": 2, "vonc": [], "do": 2, "via": 2, "setup": 2, "termin": 2, "bash": 2, "replac": 2, "project": 2, "templat": 2, "instanti": 2, "ad": 2, "pick": 2, "For": 2, "inform": 2, "check": 2, "train_config": 2, "visual": 2, "tensorboard": 2, "after": 2, "main": 2, "size": 2, "mani": 2, "One": 2, "import": 2, "thing": 2, "recogn": 2, "num_epoch": 2, "becaus": 2, "support": 2, "represent": 2, "easiest": 2, "exist": 2, "code": 2, "sub": 2, "also": 2, "vae": 2, "plot_reconstruct": 6, "orig": 6, "gif": 6, "plot": 6, "plot_trajectori": 6, "seq": 6, "traj": 6, "load_best_checkpoint": 8, "cpu": 8}, "objects": {"lib.distributions": [[1, 0, 0, "-", "core"], [1, 0, 0, "-", "normal"]], "lib.distributions.core": [[1, 1, 1, "", "Distribution"]], "lib.distributions.normal": [[1, 1, 1, "", "Normal"]], "lib.distributions.normal.Normal": [[1, 2, 1, "", "kl_divergence"], [1, 2, 1, "", "log_prob"], [1, 2, 1, "", "sample"]], "lib.models": [[4, 0, 0, "-", "core"]], "lib.models.core": [[4, 1, 1, "", "BaseSequentialModel"]], "lib.models.core.BaseSequentialModel": [[4, 2, 1, "", "__init__"], [4, 2, 1, "", "init_hidden_state"], [4, 3, 1, "", "num_parameters"], [4, 2, 1, "", "optimize"], [4, 2, 1, "", "update_hidden"]], "lib.models.tvae": [[8, 0, 0, "-", "core"], [8, 0, 0, "-", "decoder"], [8, 0, 0, "-", "encoder"]], "lib.models.tvae.core": [[8, 1, 1, "", "TVAE"]], "lib.models.tvae.core.TVAE": [[8, 2, 1, "", "__init__"], [8, 2, 1, "", "fit"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "load_best_checkpoint"], [8, 2, 1, "", "model_params"], [8, 2, 1, "", "reconstruct"], [8, 2, 1, "", "save_checkpoint"], [8, 2, 1, "", "test"]], "lib.models.tvae.decoder": [[8, 1, 1, "", "TVAEDecoder"]], "lib.models.tvae.decoder.TVAEDecoder": [[8, 2, 1, "", "__init__"], [8, 2, 1, "", "decode_action"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "generate_rollout"], [8, 2, 1, "", "init_hidden_state"], [8, 2, 1, "", "reset_policy"], [8, 2, 1, "", "update_hidden_state"]], "lib.models.tvae.encoder": [[8, 1, 1, "", "TVAEEncoder"]], "lib.models.tvae.encoder.TVAEEncoder": [[8, 2, 1, "", "__init__"], [8, 2, 1, "", "forward"]], "lib.util.datasets": [[0, 0, 0, "-", "core"]], "lib.util.datasets.core": [[0, 1, 1, "", "TrajectoryDataset"]], "lib.util.datasets.core.TrajectoryDataset": [[0, 2, 1, "", "__getitem__"], [0, 2, 1, "", "__init__"], [0, 2, 1, "", "__len__"], [0, 2, 1, "", "eval"], [0, 2, 1, "", "fit_preprocess"], [0, 2, 1, "", "load_data"], [0, 2, 1, "", "train"]], "lib.util.datasets.mouse_v1": [[6, 0, 0, "-", "core"]], "lib.util.datasets.mouse_v1.core": [[6, 1, 1, "", "MouseV1Dataset"]], "lib.util.datasets.mouse_v1.core.MouseV1Dataset": [[6, 2, 1, "", "__init__"], [6, 2, 1, "", "load_data"], [6, 2, 1, "", "med_filter"], [6, 2, 1, "", "plot_reconstruction"], [6, 2, 1, "", "plot_trajectory"], [6, 2, 1, "", "postprocess"], [6, 2, 1, "", "preprocess"], [6, 2, 1, "", "register_mars_trajectory_angles"], [6, 2, 1, "", "register_mars_trajectory_centroids"], [6, 2, 1, "", "register_pose_trajectories"]], "": [[7, 0, 0, "-", "test"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "property", "Python property"]}, "titleterms": {"lib": [0, 1, 3, 4, 6, 8, 11], "util": [0, 6, 11], "dataset": [0, 2, 6], "distribut": 1, "tvae": [2, 8, 9, 10], "encod": 10, "explan": [9, 10], "welcom": 2, "document": 2, "kennedi": 2, "lab": 2, "s": 2, "unsupervis": 2, "analysi": 2, "tool": 2, "overview": 2, "quickstart": 2, "guid": 2, "creat": 2, "new": 2, "object": 2, "set": 2, "up": 2, "experi": 2, "train": 2, "model": [2, 4, 8], "evalu": [], "perform": [], "gener": 2, "embed": 2, "treba": [2, 3], "vq": [2, 3], "modul": [2, 7], "indic": 2, "tabl": 2, "triplet": 3, "unsupervised_analysi": 5, "random_trajectori": [], "test": 7, "note": [], "decod": 9, "mouse_v1": 6, "structur": 2, "your": 2, "folder": 2, "reconstruct": 2, "done": 2, "yet": 2, "us": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})